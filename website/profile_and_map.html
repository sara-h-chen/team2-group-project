<!DOCTYPE html>
<div class="pagecontainer">
<head>
	<link type="text/css" rel="stylesheet" href="courgette_base_stylesheet.css"/>
	<link rel="stylesheet" media="screen and (max-width: 800px)" href="courgette_base_stylesheet_mobile.css" />
	<link href="https://fonts.googleapis.com/css?family=Fredoka+One|Roboto" rel="stylesheet">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
	<script src="profile_and_map.js"></script>
	<script src="MemberArea.js"></script>
	<link rel="shortcut icon" type="image/png" href="favicon.png"/>
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0' name='viewport' />
	<script>
		userID=1;
		var contact;
	</script>
	<title>COURGETTE</title>
	<style>
	</style>
</head>
<body>
	<div id ='backround'></div>
	<div id="profile_tab" onclick="openProfileMenu()"><div class='tabSign'>&#60;</div></div>
	<div id="item_tab" onclick="openItemMenu()"><div class = 'tabSign'>&#62;</div></div>
	<div id="middle">
		<div id="googleMap" style="position: relative; height:100%;"></div>
		<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBKCyGx-fEDia97mNH929xTKG2Ysgc7HtU&callback=createMap"></script>
		<div id="message_popup" class="popup">
			<div class="skinny_popup_header">
				<h2 id=message_header></h2>
				<span id='message_close' class="close">&times;</span>
			</div>
			<div class="skinny_popup_content">
				<div id='message_view'>
					<div id='messages'></div>
				</div>
			</div>
			<div class="skinny_popup_footer">
				<div id='message_send'>
					<form id='message_form'>
						<input type="text" id = 'msg_content' name= 'msg_content'>
					</form>
				</div>
				<!-- <button id="reply_to_message">Reply</button>
				<button id="delete_message">Delete</button> -->
			</div>
		</div>
		<div id="community_popup" class="popup">
			<div class="skinny_popup_header">
				<span class="close">&times;</span>
				<h2>Item Details</h2>
			</div>
			<div class="skinny_popup_content">
				<h3>Item Name - Distance</h3>
				<p>Item description here djsklkadj sdfjkidslkj hdsijodjkuj</p>
				<p>Also include same image used in side menu or maybe slideshow</p>
				<p>Of other images uploaded by the community member.</p>
			</div>
			<div class="skinny_popup_footer">
				<button id="submit">Get Item</button>
			</div>
		</div>
	</div>
	<div id="profile_menu" class="sidenav" style="overflow:hidden">
	  <a href="javascript:void(0)" class="closebtn" onclick="closeProfileMenu()">&times;</a>
	  <div id="profile_section">
		<br>
		<img id="user_profile_pic" src="profile_example.png" onclick="showEditProfileForm()">
		<input type="file" id="new_pic" style="display: none;"/><!-- browse doesn't upload new img yet!-->
		<h3 id="user_name">Generic User Name</h3>
		<div id="user_info_panel">
			<img id="sent_items" alt="Sent Food Items" src="sent_items_icon.png">
			<p id="sent_number">1040</p>
			<p id="received_number">866</p>
			<img id="received_items" alt="Received Food Items" src="received_items_icon.png">
		</div>
	  </div>
		<div id='user_item_list' style="overflow-y:scroll;">
		  
		</div>
		<div id="message_list" style="overflow-y:scroll;">
			<!-- <div class="message" id="message1">
				<p class="sender_name" id="name1">Bob Smith</p>
				<p class="sender_preview">Message preview blah blah blah .........</p>
			</div>
			<hr style="height:0.2%; visibility:hidden;"/>
			<div class="message" id="message2">
				<p class="sender_name">Anna Brown</p>
				<p class="sender_preview">Message preview blah blah blah .........</p>
			</div>
			<hr style="height:0.2%; visibility:hidden;"/>
			<div class="message" id="message4">
				<p class="sender_name">John Jones</p>
				<p class="sender_preview">Message preview blah blah blah .........</p>
			</div>
			<hr style="height:0.2%; visibility:hidden;"/> -->
		</div>
		<div id='new_food_form'>
			<input type='text' id='new_food_name' placeholder='Name of Item'><br>
			<input type='number' id='new_food_quantity' placeholder='Quantity'><br>
			Type:
			<select id='new_food_type'><br>
				<option value='VEGE'>Vegetable(s)</option>
				<option value='SEAFOOD'>Seafood</option>
				<option value='MEAT'>Meat</option>
				<option value='COOKED'>Cooked</option>
				<option value='FRUIT'>Fruit</option>
				<option value='BAKERY'>Bakery</option>
				<option value='PASTA_RICE'>Pasta/Rice</option>
				<option value='DRIED'>Dried</option>
				<option value='OTHER'>Other</option>
			</select>
			Allergen:
			<select id='new_food_allergens'><br>
				<option value='NUTS'>Nuts</option>
				<option value='GLUTEN'>Gluten</option>
				<option value='NON_VEGAN'>Non-vegan</option>
				<option value='SEAFOOD'>Seafood</option>
				<option value='EGGS'>Eggs</option>
				<option value='NONE'>None</option>
			</select>
			<button id="add_food_button" onclick='addNewFood()'>Submit</button>
		</div>
		<div id="edit_profile_form">
			Email:<br>
			<input type="text" placeholder="Email address" id="edit_profile_email"><br>
			Preferences:<br>
			<input type="checkbox" id="preferenceCheckbox0">Vegetable(s)<br>
			<input type="checkbox" id="preferenceCheckbox1">Seafood<br>
			<input type="checkbox" id="preferenceCheckbox2">Meat<br>
			<input type="checkbox" id="preferenceCheckbox3">Cooked<br>
			<input type="checkbox" id="preferenceCheckbox4">Fruit<br>
			<input type="checkbox" id="preferenceCheckbox5">Bakery<br>
			<input type="checkbox" id="preferenceCheckbox6">Pasta/Rice<br>
			<input type="checkbox" id="preferenceCheckbox7">Dried<br>
			<button onclick="updateProfile()">Submit</button>
			<a href="http://sarachen.pythonanywhere.com/password_reset">Reset Password</a>
		</div>
		<div id="message_list">
	  </div>
		<div></div>
	  <div id="icons">
		  <img src="add_item.png" alt="Add an Item" id="add_button" onclick="showNewFoodForm()"/>
		  <img src="messages.png" alt="Messages" id="message_button"/>
		  <img src="my_items.png" alt="View my Items" id="items_button" onclick="showUserFood()"/>
		  <img src="log_out.png" alt="Log Out" id="exit_button" onclick="logOut()"/>
	  </div>
	</div>

	<div id="item_menu" class="sidenav" style="overflow:hidden">
	  <a href="javascript:void(0)" class="closebtn" onclick="closeItemMenu()">&times;</a>
		Nearby Food Items:<br>
		<input type="text" id="community_food_search_box" placeholder="Search"><br>
	  <div id="community_item_list" style="overflow-y:scroll;">
	</div>
	</div>


	<!-- Add all page content inside this div if you want the side nav to push page content to the right (not used if you only want the sidenav to sit on top of the page
	<div id="user_items_list">
	  ...
	</div>!-->

	<script>
	$("#new_food_form").hide();
	$("#edit_profile_form").hide();

	$.ajax({
		url: "https://sarachen.pythonanywhere.com/backend/user/profile/",
		method: "GET",
		headers:{"Authorization":"Token " + getCookie("authToken")},
		success:function(data)
		{
			$("#user_name").html(data["username"]);
			userProfile = data;
			setUserID(data["id"]);
		}
	});

	$("input[type='image']").click(function() {
	    $("input[id='new_pic']").click();
	});

	$(document).ready(function(){
		updateMessages(userID)
		$("#message_form").submit(function(event){
			sendMessage(userID,contact,$("#msg_content").val())
			document.getElementById('message_form').reset();
			return false;
		});
	  // Hide div 2 by default
	  $('#message_list').hide();
		$("#message_popup").hide();

	  $('#message_button').click(function(){
	      $('#user_item_list').hide();
		  $("#edit_profile_form").hide();
	     	$('#message_list').show();
		  	$('#new_food_form').hide();
	  });

		$("#message_close").click(function(data){
			$("#message_popup").hide();
		});

	});
	</script>
	<script>

	//POPUP CODE WHEN CLICKING ON ITEM IMAGE IN COMMUNITY SIDE BAR
	var popup = document.getElementById('message_popup');

	// Get the button that opens the modal
	var btn = document.getElementById("name1");

	// Get the <span> element that closes the modal
	var span = document.getElementsByClassName("close")[0];

	// When the user clicks on the button, open the modal
	btn.onclick = function() {
		popup.style.display = "block";
	}

	// When the user clicks on <span> (x), close the modal
	span.onclick = function() {
		popup.style.display = "none";
	}

	// When the user clicks anywhere outside of the modal, close it
	//This causes "modal is not defined" error
	/*window.onclick = function(event) {
		if (event.target == modal) {
			modal.style.display = "none";
		}
	}*/

	function adjustStyle(width) {
	  width = parseInt(width);
	  if (width < 900) {
		$("#size-stylesheet").attr("href", "courgette_base_stylesheet_for_mobile.css");
	  } else {
		 $("#size-stylesheet").attr("href", "courgette_base_stylesheet.css");
	  }
	}

	$(function() {
	  adjustStyle($(this).width());
	  $(window).resize(function() {
		adjustStyle($(this).width());
	  });
	});

	</script>
</body>
</div>
<noscript>
    <style type="text/css">
        .pagecontainer {display:none;}
    </style>
    <div class="noscriptmsg">
		Please enable JavaScript before using this page
    </div>
</noscript>
